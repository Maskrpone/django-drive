{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>File Manager</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/stylepath.css' %}" />
    <script src="{% static 'js/script.js' %}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>
  <body>
    <!-- Bande de navigation supérieure -->
    <div class="header">
      <!-- Breadcrumb Navigation -->
        <a href="{% url 'drive_root' %}">Home</a>
        {% for key, value in breadcrumbs.items %}
          {% if key %}
            <a href="{% url 'drive' value %}">{{ key }}</a>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <!-- Titre principal -->
    <div class="title">
      <div class="text">My Files</div>
      <div class="btn-flow">
        <i class="fas fa-plus"></i>
      </div>
    </div>

    <!-- Conteneur principal pour le contenu -->
    <div class="main-container">
      
      <!-- Section gauche : dossiers et fichiers -->
      <div class="left-section">
        

      <!-- Section droite : ajout de fichiers et dossiers -->
      <div class="right-section">
        <div class="add-folder-section">
          <h1>Create a folder</h1>
          <form method="POST" action="{% url 'create_folder' %}" class="add-folder-form">
            {% csrf_token %}
            <input type="hidden" name="current_path" value="{{ current_path }}" />
            <input type="text" name="folder_name" placeholder="New folder name" class="folder-name-input" />
            <button type="submit" class="create-folder-button">Create Folder</button>
          </form>
        </div>

        <div class="upload-file-section">
          <h1>Upload a file</h1>
          <form method="POST" enctype="multipart/form-data" action="{% url 'upload_file' %}" class="upload-file-form">
            {% csrf_token %}
            <input type="hidden" name="current_path" value="{{ current_path }}" />
            {{ form.as_p }}
            <button type="submit" class="upload-file-button">Upload File</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Section du tableau de fichiers -->
    <div class="table-box">
      <table class="table">
        <thead class="table__head">
          <tr>
            <th></th>
            <th>Title</th>
            <th></th>
          </tr>
        </thead>
        <tbody class="table__body">
          <!-- Exemple d'éléments de tableau -->
          <tr>
            <td><i class="file-icon fas fa-folder"></i></td>
            <!-- Section des dossiers -->
        <div class="folder-section">
          <h3>Folders</h3>
          <ul class="folder-list">
            {% for folder in folders %}
              <li class="folder-item">
                <a href="{% url 'drive' current_path|add:folder|add:'/' %}" class="folder-link">{{ folder }}</a>
                <span class="options-icon" data-filepath="{{ current_path|add:folder|add:'/' }}">...</span>
                <div class="folder-menu" id="menu-{{ folder }}">
                  <ul>
                    <li class="delete-option" data-filepath="{{ current_path|add:folder|add:'/' }}">Supprimer</li>
                    <li class="move-option" data-filepath="{{ current_path|add:folder|add:'/' }}">Déplacer</li>
                    <li class="copy-option" data-filepath="{{ current_path|add:folder|add:'/' }}">Copier</li>
                  </ul>
                </div>
              </li>
            {% empty %}
              <li class="no-folder">No folders</li>
            {% endfor %}
          </ul>
        </div>

        <!-- Section des fichiers -->
        <div class="file-section">
          <h3>Files</h3>
          <ul class="file-list">
            {% for file in files %}
              <li class="file-item">
                <a href="{{ file }}" class="file-link">{{ file }}</a>
                <span class="options-icon" data-filepath="{{ file }}">...</span>
                <div class="file-menu" id="menu-{{ file }}">
                  <ul>
                    <li class="copy-option" data-filepath="{{ file }}">Copier</li>
                    <li class="move-option" data-filepath="{{ file }}">Déplacer</li>
                    <li class="delete-option" data-filepath="{{ file }}">Supprimer</li>
                  </ul>
                </div>
              </li>
            {% empty %}
              <li class="no-file">No files</li>
            {% endfor %}
          </ul>
        </div>

      </div>
            <td><i class="fas fa-ellipsis-v" data-behavior="file-settings"></i>
              <ul class="file-menu collapsed">
                <li>Rename</li>
                <li>Move</li>
                <li>Delete</li>
                <li>Properties</li>
              </ul>
            </td>
          </tr>
          <!-- Ajouter ici d'autres fichiers ou dossiers -->
        </tbody>
      </table>
    </div>

    <script>
      // Gestion du menu d'options
      $('.options-icon').click(function() {
        const filepath = $(this).data('filepath');
        $(`#menu-${filepath}`).toggle();
      });

      // Autres actions JavaScript ici...
    </script>
  </body>
</html>
